defaultImage: nginx:latest

apps:
  - name: voila
    service:
      enabled: true
      type: ClusterIP
      command: ["voila", "--no-browser", "--enable_nbextensions=True", "--Voila.ip=0.0.0.0", "report.ipynb"]
      ports:
        - name: http
          port: 8866
          protocol: TCP
      autoscaling:
        enabled: true
        minReplicas: 1
        maxReplicas: 1
        targetCPUUtilizationPercentage: 99
        targetMemoryUtilizationPercentage: 99
      ingress:
        hosts:
          - host: tiphyspy.opszero.com
            paths: ["/"]
            port: 8866
      healthChecks:
        lifecycle:
          preStop:
            exec:
              command:
                - /bin/sh
                - -c
                - sleep 10
        livenessProbe:
          failureThreshold: 15
          initialDelaySeconds: 1
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 30
          httpGet:
            path: /
            port: 8866
        readinessProbe:
          failureThreshold: 15
          initialDelaySeconds: 1
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 30
          httpGet:
            path: /
            port: 8866